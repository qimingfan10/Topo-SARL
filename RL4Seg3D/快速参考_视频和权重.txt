â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ¯ å¿«é€Ÿå‚è€ƒï¼šè§†é¢‘è½¬æ¢å’Œæœ€ä½³æƒé‡ä¿å­˜
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Œ é—®é¢˜æ€»ç»“
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

é—®é¢˜1: è§†é¢‘å¤ªçŸ­ï¼ˆ0.2ç§’å°±ç»“æŸï¼‰
åŸå› : rewardDSåªæœ‰2å¸§ï¼ˆé¢„æµ‹æ—¶ä½¿ç”¨æ»‘åŠ¨çª—å£ï¼‰+ æ—§FPS=10
ä¿®å¤: âœ… é™ä½FPSåˆ°5ï¼ˆé»˜è®¤ï¼‰æˆ–2ï¼ˆæ¨èï¼‰

é—®é¢˜2: è®­ç»ƒæ—¶æ²¡æœ‰ä¿å­˜æœ€ä½³æƒé‡
åŸå› : ModelCheckpointé…ç½®ç¼ºå°‘save_top_kå‚æ•°
ä¿®å¤: âœ… æ·»åŠ save_top_k=1ï¼Œè‡ªåŠ¨ä¿å­˜best.ckpt

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ¬ è§†é¢‘è½¬æ¢å‘½ä»¤ï¼ˆä¸‰ç§åœºæ™¯ï¼‰
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ã€åœºæ™¯1ã€‘è½¬æ¢rewardDSé¢„æµ‹ç»“æœï¼ˆåªæœ‰2å¸§ï¼‰- æ¨èfps=2
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

# åŸºç¡€è½¬æ¢ï¼ˆfps=2, 1ç§’è§†é¢‘ï¼‰
python3 scripts/nifti_to_mp4.py \
    -i /home/ubuntu/my_rl4seg3d_logs/3d_test/rewardDS \
    -o /home/ubuntu/videos \
    --reward-dataset \
    --fps 2

# å åŠ æ˜¾ç¤ºï¼ˆå›¾åƒ+GT+é¢„æµ‹ï¼‰
python3 scripts/nifti_to_mp4.py \
    -i /home/ubuntu/my_rl4seg3d_logs/3d_test/rewardDS \
    -o /home/ubuntu/videos_overlay \
    --reward-dataset \
    --fps 2

æ•ˆæœ: 2å¸§/2fps = 1ç§’è§†é¢‘ï¼ˆå®¹æ˜“è§‚çœ‹ï¼‰

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ã€åœºæ™¯2ã€‘è½¬æ¢åŸå§‹å®Œæ•´æ•°æ®ï¼ˆ20å¸§ï¼‰- æ¨èfps=10
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

# å•ä¸ªæ–‡ä»¶
python3 scripts/nifti_to_mp4.py \
    -i /home/ubuntu/my_organized_dataset/img/study1/view1/xxx_0000.nii.gz \
    -o /home/ubuntu/original.mp4 \
    --fps 10

# æ‰¹é‡è½¬æ¢æ•´ä¸ªç›®å½•
python3 scripts/nifti_to_mp4.py \
    -i /home/ubuntu/my_organized_dataset/img \
    -o /home/ubuntu/original_videos \
    --batch \
    --fps 10

æ•ˆæœ: 20å¸§/10fps = 2ç§’è§†é¢‘ï¼ˆæ­£å¸¸é€Ÿåº¦ï¼‰

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ã€åœºæ™¯3ã€‘è‡ªå®šä¹‰FPS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

FPSé€ŸæŸ¥è¡¨ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¸§æ•°    â”‚  fps=2   â”‚  fps=5   â”‚  fps=10  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2å¸§     â”‚  1.0ç§’   â”‚  0.4ç§’   â”‚  0.2ç§’   â”‚
â”‚ 5å¸§     â”‚  2.5ç§’   â”‚  1.0ç§’   â”‚  0.5ç§’   â”‚
â”‚ 10å¸§    â”‚  5.0ç§’   â”‚  2.0ç§’   â”‚  1.0ç§’   â”‚
â”‚ 20å¸§    â”‚ 10.0ç§’   â”‚  4.0ç§’   â”‚  2.0ç§’   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ¨èé…ç½®ï¼š
â€¢ 2-5å¸§   â†’ fps=2  (æ…¢é€Ÿï¼Œå®¹æ˜“è§‚å¯Ÿç»†èŠ‚)
â€¢ 10-20å¸§ â†’ fps=10 (æ­£å¸¸é€Ÿåº¦)
â€¢ 50å¸§+   â†’ fps=25 (æ¥è¿‘çœŸå®è§†é¢‘)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ’¾ è®­ç»ƒæ£€æŸ¥ç‚¹ï¼ˆCheckpointï¼‰è¯´æ˜
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

è®­ç»ƒåä¼šç”Ÿæˆï¼š
ğŸ“‚ /home/ubuntu/my_rl4seg3d_logs/3d_test/PPO3D_*/version_*/checkpoints/
â”œâ”€â”€ ğŸ“„ last.ckpt                              # æœ€åä¸€ä¸ªepoch
â””â”€â”€ ğŸ“„ best-epoch=42-val_reward=0.6543.ckpt  # æœ€ä½³æ€§èƒ½

ç”¨é€”ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ£€æŸ¥ç‚¹     â”‚ ç”¨é€”          â”‚ ä½•æ—¶ä½¿ç”¨        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ last.ckpt  â”‚ ç»§ç»­è®­ç»ƒ      â”‚ è‡ªåŠ¨åŠ è½½        â”‚
â”‚ best.ckpt  â”‚ è¯„ä¼°/éƒ¨ç½²     â”‚ æ‰‹åŠ¨æŒ‡å®š        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… ç»§ç»­è®­ç»ƒï¼ˆè‡ªåŠ¨ä½¿ç”¨last.ckptï¼‰ï¼š
python3 rl4seg3d/auto_iteration.py

âœ… ä»best.ckptç»§ç»­è®­ç»ƒï¼ˆæ‰‹åŠ¨æŒ‡å®šï¼‰ï¼š
# ç¼–è¾‘ rl4seg3d/config/auto_iteration.yaml
pretrain_path: /path/to/best-epoch=XX-val_reward=X.XXXX.ckpt

python3 rl4seg3d/auto_iteration.py

âœ… è¯„ä¼°æœ€ä½³æ¨¡å‹ï¼š
python3 scripts/evaluate_predictions.py \
    --reward-ds-path /home/ubuntu/my_rl4seg3d_logs/3d_test/rewardDS

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ”§ æŸ¥çœ‹å·²ä¿å­˜çš„æ£€æŸ¥ç‚¹
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

# æŸ¥æ‰¾æ‰€æœ‰æ£€æŸ¥ç‚¹
find /home/ubuntu/my_rl4seg3d_logs/3d_test -name "*.ckpt" -type f

# æŸ¥æ‰¾bestå’Œlastæ£€æŸ¥ç‚¹
find /home/ubuntu/my_rl4seg3d_logs/3d_test -name "*.ckpt" -type f | grep -E "(last|best)"

# æŸ¥çœ‹æ£€æŸ¥ç‚¹è¯¦ç»†ä¿¡æ¯ï¼ˆåŒ…æ‹¬å¤§å°å’Œä¿®æ”¹æ—¶é—´ï¼‰
find /home/ubuntu/my_rl4seg3d_logs/3d_test -name "*.ckpt" -type f -exec ls -lh {} \;

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Š å®Œæ•´å·¥ä½œæµç¨‹
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1ï¸âƒ£ è®­ç»ƒæ¨¡å‹
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
cd /home/ubuntu/RL4Seg3D
python3 rl4seg3d/auto_iteration.py

è¾“å‡ºï¼š
âœ… last.ckpt  (è‡ªåŠ¨ç”¨äºç»§ç»­è®­ç»ƒ)
âœ… best.ckpt  (æœ€ä½³æ€§èƒ½ï¼Œç”¨äºè¯„ä¼°)
âœ… rewardDS/  (é¢„æµ‹ç»“æœï¼Œ2å¸§)

2ï¸âƒ£ è¯„ä¼°æ¨¡å‹
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
python3 scripts/evaluate_predictions.py \
    --reward-ds-path /home/ubuntu/my_rl4seg3d_logs/3d_test/rewardDS

è¾“å‡ºï¼šACC, PRE, SEN, SPE, F1, IoU, DSC

3ï¸âƒ£ å¯è§†åŒ–ç»“æœï¼ˆrewardDSï¼Œ2å¸§ï¼‰
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
python3 scripts/nifti_to_mp4.py \
    -i /home/ubuntu/my_rl4seg3d_logs/3d_test/rewardDS \
    -o /home/ubuntu/videos \
    --reward-dataset \
    --fps 2

è¾“å‡ºï¼š1ç§’è§†é¢‘ï¼ˆimage.mp4, gt_overlay.mp4, pred_overlay.mp4ï¼‰

4ï¸âƒ£ å¯è§†åŒ–åŸå§‹æ•°æ®ï¼ˆå®Œæ•´20å¸§ï¼‰
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
python3 scripts/nifti_to_mp4.py \
    -i /home/ubuntu/my_organized_dataset/img \
    -o /home/ubuntu/original_videos \
    --batch \
    --fps 10

è¾“å‡ºï¼š2ç§’è§†é¢‘ï¼ˆå®Œæ•´åºåˆ—ï¼‰

5ï¸âƒ£ ç»§ç»­è®­ç»ƒï¼ˆå¯é€‰ï¼‰
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# è‡ªåŠ¨ä»last.ckptç»§ç»­ï¼ˆæ— éœ€ä»»ä½•ä¿®æ”¹ï¼‰
python3 rl4seg3d/auto_iteration.py

# æˆ–ä»best.ckptç»§ç»­ï¼ˆéœ€ä¿®æ”¹é…ç½®ï¼‰
# ç¼–è¾‘ rl4seg3d/config/auto_iteration.yaml
pretrain_path: /path/to/best-*.ckpt

python3 rl4seg3d/auto_iteration.py

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â“ å¸¸è§é—®é¢˜
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Q1: ä¸ºä»€ä¹ˆrewardDSåªæœ‰2å¸§ï¼Œè€ŒåŸå§‹æ•°æ®æœ‰20å¸§ï¼Ÿ
A1: å› ä¸ºPPOé¢„æµ‹æ—¶ä½¿ç”¨äº†æ»‘åŠ¨çª—å£ï¼ˆwindow_size=2ï¼‰ï¼Œæ¯æ¬¡åªå¤„ç†
    2å¸§ã€‚å¦‚æœéœ€è¦å®Œæ•´åºåˆ—ï¼Œéœ€è¦ä¿®æ”¹predicté€»è¾‘ï¼ˆè¾ƒå¤æ‚ï¼‰ã€‚

Q2: è§†é¢‘è¿˜æ˜¯å¤ªçŸ­æ€ä¹ˆåŠï¼Ÿ
A2: ä¸‰ä¸ªé€‰æ‹©ï¼š
    â€¢ é™ä½FPS: --fps 2 æˆ– --fps 1
    â€¢ è½¬æ¢åŸå§‹20å¸§æ•°æ®ï¼ˆä¸æ˜¯rewardDSï¼‰
    â€¢ ä¿®æ”¹RLmodule_3D.pyçš„predicté€»è¾‘ï¼ˆå¤æ‚ï¼‰

Q3: ç»§ç»­è®­ç»ƒä¼šç”¨å“ªä¸ªcheckpointï¼Ÿ
A3: è‡ªåŠ¨ä½¿ç”¨last.ckptï¼Œä¸ä¼šç ´åè®­ç»ƒæµç¨‹ã€‚
    best.ckptåªåœ¨ä½ æ‰‹åŠ¨æŒ‡å®šæ—¶ä½¿ç”¨ã€‚

Q4: å¦‚ä½•æŸ¥çœ‹å“ªä¸ªepochæ€§èƒ½æœ€å¥½ï¼Ÿ
A4: æŸ¥çœ‹TensorBoardæˆ–æ£€æŸ¥best.ckptçš„æ–‡ä»¶åï¼š
    best-epoch=42-val_reward=0.6543.ckpt
    â†‘è¿™é‡Œæ˜¯epoch 42ï¼Œval/reward=0.6543

Q5: è®­ç»ƒå®Œå¦‚ä½•çŸ¥é“ä¿å­˜äº†å“ªäº›æ–‡ä»¶ï¼Ÿ
A5: è¿è¡Œï¼š
    find /home/ubuntu/my_rl4seg3d_logs/3d_test -type f \
        -name "*.ckpt" -o -name "*.mp4" -o -name "*.csv"

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ¯ æ ¸å¿ƒè¦ç‚¹
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… è§†é¢‘FPSå·²ä¼˜åŒ–ï¼ˆé»˜è®¤5â†’å»ºè®®æ”¹ä¸º2ï¼‰
âœ… æœ€ä½³æƒé‡ä¼šè‡ªåŠ¨ä¿å­˜ï¼ˆsave_top_k=1ï¼‰
âœ… ç»§ç»­è®­ç»ƒé€»è¾‘å®Œå…¨ä¸å—å½±å“
âœ… æ‰€æœ‰åŠŸèƒ½æµ‹è¯•é€šè¿‡

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“š è¯¦ç»†æ–‡æ¡£
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â€¢ å®Œæ•´è¯´æ˜:   /home/ubuntu/RL4Seg3D/è§†é¢‘å’Œæƒé‡é—®é¢˜ä¿®å¤è¯´æ˜.md
â€¢ è¯„ä¼°æŒ‡æ ‡:   /home/ubuntu/RL4Seg3D/è¯„ä¼°æŒ‡æ ‡è¯´æ˜.md
â€¢ è®­ç»ƒæ€»ç»“:   /home/ubuntu/RL4Seg3D/è®­ç»ƒç»“æœæ€»ç»“.txt
â€¢ å¥–åŠ±å‡½æ•°:   /home/ubuntu/RL4Seg3D/å¥–åŠ±å‡½æ•°è¯¦è§£.md
â€¢ æ•°æ®æ ¼å¼:   /home/ubuntu/RL4Seg3D/æ•°æ®æ ¼å¼å’Œä½¿ç”¨è¯´æ˜.md

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… æ‰€æœ‰é—®é¢˜å·²ä¿®å¤ï¼å¯ä»¥å¼€å§‹æ–°çš„è®­ç»ƒäº†ï¼
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

